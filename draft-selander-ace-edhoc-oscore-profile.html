<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Ephemeral Diffie-Hellman Over COSE (EDHOC) and Object Security for Constrained Environments (OSCORE) Profile for Authentication and Authorization for Constrained Environments (ACE)</title>
<meta content="Göran Selander" name="author">
<meta content="John Preuß Mattsson" name="author">
<meta content="Marco Tiloca" name="author">
<meta content="Rikard Höglund" name="author">
<meta content="
       This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework.
It utilizes Ephemeral Diffie-Hellman Over COSE (EDHOC) for achieving mutual authentication between an OAuth 2.0 Client and Resource Server, and it binds an authentication credential of the Client to an OAuth 2.0 access token.
EDHOC also establishes an Object Security for Constrained RESTful Environments (OSCORE) Security Context, which is used to secure communications when accessing protected resources according to the authorization information indicated in the access token.
A resource-constrained server can use this profile to delegate management of authorization information to a trusted host with less severe limitations regarding processing power and memory. 
    " name="description">
<meta content="xml2rfc 3.12.10" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-selander-ace-edhoc-oscore-profile-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.10
    Python 3.10.4
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.1
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.4.0
    six 1.16.0
-->
<link href="draft-selander-ace-edhoc-oscore-profile.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
dd.break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: 14.5px;
}
.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([stroke="fill"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">CoAP-EDHOC-OSCORE</td>
<td class="right">June 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Selander, et al.</td>
<td class="center">Expires 9 December 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ACE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-selander-ace-edhoc-oscore-profile-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-06-07" class="published">7 June 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-12-09">9 December 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">G. Selander</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">J. Preuß Mattsson</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE</div>
</div>
<div class="author">
      <div class="author-name">R. Höglund</div>
<div class="org">RISE</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Ephemeral Diffie-Hellman Over COSE (EDHOC) and Object Security for Constrained Environments (OSCORE) Profile for Authentication and Authorization for Constrained Environments (ACE)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework.
It utilizes Ephemeral Diffie-Hellman Over COSE (EDHOC) for achieving mutual authentication between an OAuth 2.0 Client and Resource Server, and it binds an authentication credential of the Client to an OAuth 2.0 access token.
EDHOC also establishes an Object Security for Constrained RESTful Environments (OSCORE) Security Context, which is used to secure communications when accessing protected resources according to the authorization information indicated in the access token.
A resource-constrained server can use this profile to delegate management of authorization information to a trusted host with less severe limitations regarding processing power and memory.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    Authentication and Authorization for Constrained Environments Working Group mailing list (ace@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/ace/">https://mailarchive.ietf.org/arch/browse/ace/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/EricssonResearch/ace-edhoc-oscore-profile">https://github.com/EricssonResearch/ace-edhoc-oscore-profile</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 9 December 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-protocol-overview" class="xref">Protocol Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-protocol-flow" class="xref">Protocol Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-communication-between-the-c" class="xref">Communication Between the Client and the Authorization Server</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-raw-public-key-mode" class="xref">Raw Public Key Mode</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-access-token-retrieval-from" class="xref">Access Token Retrieval from the Authorization Server</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="xref">3.2.2</a>.  <a href="#name-dtls-channel-setup-between-" class="xref">DTLS Channel Setup Between Client and Resource Server</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-resource-access" class="xref">Resource Access</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-dynamic-update-of-authoriza" class="xref">Dynamic Update of Authorization Information</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-token-expiration" class="xref">Token Expiration</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-secure-communication-with-a" class="xref">Secure Communication with an Authorization Server</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-edhoc-application-profile-p" class="xref">EDHOC Application Profile Parameters</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-reuse-of-existing-sessions" class="xref">Reuse of Existing Sessions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-multiple-access-tokens" class="xref">Multiple Access Tokens</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-out-of-band-configuration" class="xref">Out-of-Band Configuration</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-ace-oauth-profile-registry" class="xref">ACE OAuth Profile Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-oauth-parameters-registry" class="xref">OAuth Parameters Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="xref">10.3</a>.  <a href="#name-oauth-parameters-cbor-mappi" class="xref">OAuth Parameters CBOR Mappings Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="xref">10.4</a>.  <a href="#name-json-web-token-claims-regis" class="xref">JSON Web Token Claims Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="xref">10.5</a>.  <a href="#name-cbor-web-token-claims-regis" class="xref">CBOR Web Token Claims Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.6">
                <p id="section-toc.1-1.10.2.6.1"><a href="#section-10.6" class="xref">10.6</a>.  <a href="#name-jwt-confirmation-methods-re" class="xref">JWT Confirmation Methods Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.7">
                <p id="section-toc.1-1.10.2.7.1"><a href="#section-10.7" class="xref">10.7</a>.  <a href="#name-cwt-confirmation-methods-re" class="xref">CWT Confirmation Methods Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.8">
                <p id="section-toc.1-1.10.2.8.1"><a href="#section-10.8" class="xref">10.8</a>.  <a href="#name-edhoc-application-profile-pa" class="xref">EDHOC Application Profile Parameters Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.9">
                <p id="section-toc.1-1.10.2.9.1"><a href="#section-10.9" class="xref">10.9</a>.  <a href="#name-expert-review-instructions" class="xref">Expert Review Instructions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-examples" class="xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-workflow-without-optimizati" class="xref">Workflow without Optimizations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-workflow-with-optimizations" class="xref">Workflow with Optimizations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#appendix-A.3" class="xref">A.3</a>.  <a href="#name-workflow-without-optimizatio" class="xref">Workflow without Optimizations (AS token posting)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This specification defines the "coap_edhoc_oscore" profile of the ACE framework <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. This profile addresses a "zero-touch" constrained setting where trusted operations can be performed with low overhead without endpoint specific configurations.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Like in the "coap_oscore" profile <span>[<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>, also in this profile a client (C) and a resource server (RS) use the Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> to communicate, and Object Security for Constrained RESTful Environments (OSCORE) <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> to protect their communications. Besides, the processing of requests for specific protected resources is identical to what is defined in the "coap_oscore" profile.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">When using this profile, C accesses protected resources hosted at the RS with the use of an access token issued by a trusted authorization server (AS) and bound to an authentication credential of C. This differs from the "coap_oscore" profile, where the access token is bound to a symmetric key used to derive OSCORE keying material. As recommended in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, this specification uses CBOR Web Tokens (CWTs) <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span> as access tokens.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The authentication and authorization workflow requires C and the RS to have access to each other's authentication credentials. In particular, C obtains both an access token and an authentication credential of the RS from the AS, while the RS can obtain the access token for C (and the authentication credential of C included therin) through different possible options. If the RS successfully verifies the access token, then C and the RS run the Ephemeral Diffie-Hellman Over COSE (EDHOC) protocol <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>, with each peer using its own and the other peer's authentication credential.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Once completed the EDHOC execution, C and the RS are mutually authenticated and establish an OSCORE Security Context to protect following communications, while the RS achieves proof of possession of the private key of C. Instead, C achieves proof of possession of the private key of the RS either once completed the EDHOC execution (if an optional, fourth EDHOC message is sent by the RS) or after the first message exchange using OSCORE.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Authentication credentials can be a raw public key, e.g., encoded as a CWT Claims Set (CCS, <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span>); or a public key certificate, e.g., encoded as an X.509 certificate or as a CBOR encoded X.509 certificate (C509, <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>); or a different type of data structure containing (or uniquely referring to) the public key of the peer in question.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">The ACE protocol establishes what those authentication credentials are, and may transport the actual authentication credentials by value or rather uniquely refer to them. If an actual authentication credential is pre-provisioned or can be obtained over less constrained links, then it suffices that ACE provides a unique reference such as a certificate hash (e.g., by using the COSE header parameter "x5t", see <span>[<a href="#I-D.ietf-cose-x509" class="xref">I-D.ietf-cose-x509</a>]</span>). This is in the same spirit as EDHOC, where the authentication credentials may be transported or referenced in the ID_CRED_x message fields (see Section 3.5.3 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>).<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">Generally, the AS and RS are likely to have trusted access to each other's authentication credentials, since the AS acts on behalf of the RS as per the trust model of ACE. Also, the AS needs to have some information about C, including the respective authentication credential, in order to identify C when it requests an access token and to determine what access rights it can be granted. However, the authentication credential of C may potentially be conveyed (or uniquely referred to) within the request sent to the AS.<a href="#section-1-8" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
"OPTIONAL" in this document are to be interpreted as described in BCP
14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all
capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with security for CoAP <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> based on OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> and EDHOC <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>.
Readers are also expected to be familiar with the terms and concepts of the ACE framework
described in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> and in <span>[<a href="#I-D.ietf-ace-oauth-params" class="xref">I-D.ietf-ace-oauth-params</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">The authorization information (authz-info) resource refers to the authorization information endpoint as specified in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.
The term <code>claim</code> is used in this document with the same semantics
as in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, i.e., it denotes information carried
in the access token or returned from introspection.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-protocol-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-2-1">This section gives an overview of how to use the ACE framework <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> together with the EDHOC authentication protocol to generate an OSCORE security context with associated authorization information.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The RS maintains a collection of authentication credentials with associated OSCORE security context and authorization information for all the clients that it is communicating with. The authorization information is maintained as policy that is used as input to processing requests from those clients.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">This profile requires C to retrieve an access token from the AS for the resource it wants to access on an RS, by sending an access token request to the token endpoint, as specified in Section 5.8 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. The access token request and response MUST be confidentiality protected and ensure authenticity. The use of EDHOC and OSCORE between the client and AS is RECOMMENDED in this profile, to reduce the number of libraries C has to support, but other protocols fulfilling the security requirements defined in Section 5 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> MAY alternatively be used, such as TLS <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> or DTLS <span>[<a href="#RFC9147" class="xref">RFC9147</a>]</span>.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">Once C has retrieved the access token, it posts the token to the RS, either using the authz-info endpoint and mechanisms specified in Section 5.8 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> and Content-Format = application/ace+cbor, or with EAD_1 of EDHOC message_1 using the External Authorization Data (EAD) mechanism of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span> as further detailed in this document.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">In the former case, if the access token is valid, the RS responds to the request with a 2.01 (Created) response with Content-Format = application/ace+cbor. In this case and in the latter case above, C and RS mutually authenticate using EDHOC and if successful derive an OSCORE security context. The RS associates C with the access rights of the received token.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">When using this profile, the communication with the authz-info endpoint is not protected, except for the update of access rights.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">C gains authorized access to protected resources on RS as long as the access token is valid. The OSCORE security context is discarded when a token (whether the same or a different one) is used to successfully derive a new security context for that client, either by using the EDHOC-KeyUpdate procedure or re-running the EDHOC protocol.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">After the whole message exchange has taken place, the client can contact the AS to request an update of its access rights, sending a similar request to the token endpoint that also includes an identifier so that the AS can find the correct data it has previously shared with the client. This specific identifier, encoded as a byte string, is assigned by the AS to be unique in the sets of granted client access rights.<a href="#section-2-8" class="pilcrow">¶</a></p>
<p id="section-2-9">An overview of the protocol flow for the <code>coap_edhoc_oscore</code> profile is given in <a href="#protocol-overview" class="xref">Figure 1</a>. The names of messages coincide with those of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> when applicable.<a href="#section-2-9" class="pilcrow">¶</a></p>
<span id="name-protocol-overview-2"></span><div id="protocol-overview">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-2-10.1">
<pre>
   C                            RS                   AS
   |                            |                     |
   | &lt;== Mutual authentication and secure channel ==&gt; |
   |                            |                     |
   | ----- POST /token  ----------------------------&gt; |
   |                            |                     |
   | &lt;---------------------------- Access Token ----- |
   |                           + Access Information   |
   |                            |                     |
   | [--- POST /authz-info --&gt;] |                     |
   |       (access_token)       |                     |
   |                            |                     |
   | [&lt;---- 2.01 Created  ----] |                     |
   |                            |                     |
   | &lt;========= EDHOC ========&gt; |                     |
   |  OSCORE Sec Context deriv. |                     |
   |                            |                     |
Sec Context storage/    Sec Context storage/          |
   |                            |                     |
   | ---- OSCORE Request -----&gt; |                     |
   |                            |                     |
   | &lt;--- OSCORE Response ----- |                     |
   |                            |                     |
   |           ...              |                     |

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-protocol-overview-2" class="selfRef">Protocol Overview</a>
        </figcaption></figure>
</div>
<p id="section-2-11">NOTE: The rest of the draft is a copy of draft-ietf-ace-dtls-authorize. The mode of writing has been to compare the text below with draft-ietf-ace-oscore-profile (for which there is no Markdown document) and selected relevant parts from respective drafts.<a href="#section-2-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-flow">
<section id="section-3">
      <h2 id="name-protocol-flow">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-protocol-flow" class="section-name selfRef">Protocol Flow</a>
      </h2>
<p id="section-3-1">The following sections specify how CoAP is used to interchange
access-related data between the resource server, the client and the
authorization server so that the authorization server can provide the
client and the resource server with sufficient information to
establish a secure channel, and convey authorization information
specific for this communication relationship to the resource server.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2"><a href="#C-AS-comm" class="xref">Section 3.1</a> describes how the communication between the client (C) and
the authorization server (AS) must be secured.
Depending on the used CoAP security mode (see also
Section 9 of <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>,
the Client-to-AS request, AS-to-Client response and DTLS session
establishment carry slightly different information. <a href="#rpk-mode" class="xref">Section 3.2</a>
addresses the use of raw public keys.<a href="#section-3-2" class="pilcrow">¶</a></p>
<div id="C-AS-comm">
<section id="section-3.1">
        <h3 id="name-communication-between-the-c">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-communication-between-the-c" class="section-name selfRef">Communication Between the Client and the Authorization Server</a>
        </h3>
<p id="section-3.1-1">To retrieve an access token for the resource that the client wants to
access, the client requests an access token from the authorization
server. Before the client can request the access token, the client and
the authorization server MUST establish
a secure communication channel. This profile assumes that the keying
material to secure this communication channel has securely been obtained
either by manual configuration or in an automated provisioning process.
The following requirements in alignment with Section 6.5 of
<span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> therefore must be met:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">The client MUST securely have obtained keying material to communicate
with the authorization server.<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.2">Furthermore, the client MUST verify that the authorization server is
authorized to provide access tokens (including authorization
information) about the resource server to the client, and that
this authorization information about the authorization server is still valid.<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.3">Also, the authorization server MUST securely have obtained keying
material for the client, and obtained authorization rules approved
by the resource owner (RO) concerning the client and the resource
server that relate to this keying material.<a href="#section-3.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-3">The client and the authorization server MUST use their respective
keying material for all exchanged messages. How the security
association between the client and the authorization server is
bootstrapped is not part of this document. The client and the
authorization server must ensure the confidentiality, integrity and
authenticity of all exchanged messages within the ACE protocol.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4"><a href="#as-commsec" class="xref">Section 6</a> specifies how communication with the authorization server is secured.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rpk-mode">
<section id="section-3.2">
        <h3 id="name-raw-public-key-mode">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-raw-public-key-mode" class="section-name selfRef">Raw Public Key Mode</a>
        </h3>
<p id="section-3.2-1">When the client uses raw public key authentication, the procedure is as
described in the following.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div id="access-token-retrieval-from-the-authorization-server">
<section id="section-3.2.1">
          <h4 id="name-access-token-retrieval-from">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-access-token-retrieval-from" class="section-name selfRef">Access Token Retrieval from the Authorization Server</a>
          </h4>
<p id="section-3.2.1-1">After the client and the authorization server mutually authenticated each other and validated each
other's authorization, the client sends a token request to the authorization server's token endpoint.
The client MUST add a <code>req_cnf</code> object carrying either its raw public key
or a unique identifier for a public key that it has previously made
known to the authorization server. It is RECOMMENDED that
the client uses DTLS with the same keying material to secure the
communication with the authorization server, proving possession of the key
as part of the token request. Other mechanisms for proving possession of
the key may be defined in the future.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">An example access token request from the client to the authorization
server is depicted in <a href="#rpk-authorization-message-example" class="xref">Figure 2</a>.<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<span id="name-access-token-request-exampl"></span><div id="rpk-authorization-message-example">
<figure id="figure-2">
            <div class="alignLeft art-text artwork" id="section-3.2.1-3.1">
<pre>
   POST coaps://as.example.com/token
   Content-Format: application/ace+cbor
   Payload:
   {
     grant_type : client_credentials,
     audience   : "tempSensor4711",
     req_cnf    : {
       COSE_Key : {
         kty : EC2,
         crv : P-256,
         x   : h'e866c35f4c3c81bb96a1...',
         y   : h'2e25556be097c8778a20...'
       }
     }
   }
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-access-token-request-exampl" class="selfRef">Access Token Request Example for RPK Mode</a>
            </figcaption></figure>
</div>
<p id="section-3.2.1-4">The example shows an access token request for the resource identified
by the string "tempSensor4711" on the authorization server
using a raw public key.<a href="#section-3.2.1-4" class="pilcrow">¶</a></p>
<p id="section-3.2.1-5">The authorization server MUST check if the client that it communicates
with is associated with the RPK in the <code>req_cnf</code> parameter before
issuing an access token to it.  If the authorization server determines
that the request is to be authorized according to the respective
authorization rules, it generates an access token response for the
client. The access token MUST be bound to the RPK of the client by
means of the <code>cnf</code> claim.<a href="#section-3.2.1-5" class="pilcrow">¶</a></p>
<p id="section-3.2.1-6">The response MUST contain an <code>ace_profile</code> parameter if
the <code>ace_profile</code> parameter in the request is empty, and MAY contain
this parameter otherwise (see Section 5.8.2 of
<span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>). This parameter is set to <code>coap_dtls</code> to
indicate that this profile MUST be used for communication between the
client and the resource server. The response
also contains an access token with information for the resource server
about the client's public key. The authorization server MUST return in
its response the parameter <code>rs_cnf</code> unless it is certain that the
client already knows the public key of the resource server.  The
authorization server MUST ascertain that the RPK specified in <code>rs_cnf</code>
belongs to the resource server that the client wants to communicate
with. The authorization server MUST protect the integrity of the
access token such that the resource server can detect unauthorized
changes.  If the access token contains confidential data, the
authorization server MUST also protect the confidentiality of the
access token.<a href="#section-3.2.1-6" class="pilcrow">¶</a></p>
<p id="section-3.2.1-7">The client MUST ascertain that the access token response belongs to a certain
previously sent access token request, as the request may specify the
resource server with which the client wants to communicate.<a href="#section-3.2.1-7" class="pilcrow">¶</a></p>
<p id="section-3.2.1-8">An example access token response from the authorization server to the client
is depicted in <a href="#rpk-authorization-response-example" class="xref">Figure 3</a>. Here, the
contents of the <code>access_token</code> claim have been truncated to improve
readability. The response comprises access information for the client
that contains the server's public key in the <code>rs_cnf</code> parameter.
Caching proxies process the Max-Age option in the CoAP response which
has a default value of 60 seconds (Section 5.6.1 of <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>).
The authorization server SHOULD
adjust the Max-Age option such that it does not exceed the
<code>expires_in</code> parameter to avoid stale responses.<a href="#section-3.2.1-8" class="pilcrow">¶</a></p>
<span id="name-access-token-response-examp"></span><div id="rpk-authorization-response-example">
<figure id="figure-3">
            <div class="alignLeft art-text artwork" id="section-3.2.1-9.1">
<pre>
   2.01 Created
   Content-Format: application/ace+cbor
   Max-Age: 3560
   Payload:
   {
     access_token : b64'SlAV32hkKG...
      (remainder of CWT omitted for brevity;
      CWT contains the client's RPK in the cnf claim)',
     expires_in : 3600,
     rs_cnf     : {
       COSE_Key : {
         kty : EC2,
         crv : P-256,
         x   : h'd7cc072de2205bdc1537...',
         y   : h'f95e1d4b851a2cc80fff...'
       }
     }
   }
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-access-token-response-examp" class="selfRef">Access Token Response Example for RPK Mode</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="rpk-dtls-channel">
<section id="section-3.2.2">
          <h4 id="name-dtls-channel-setup-between-">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-dtls-channel-setup-between-" class="section-name selfRef">DTLS Channel Setup Between Client and Resource Server</a>
          </h4>
<p id="section-3.2.2-1">Before the client initiates the DTLS handshake with the resource
server, the client MUST send a <code>POST</code> request containing the obtained
access token to the authz-info resource hosted by the resource
server. After the client receives a confirmation that the resource
server has accepted the access token, it proceeds to establish a
new DTLS channel with the resource server.  The client MUST use its
correct public key in the DTLS handshake. If the authorization server
has specified a <code>cnf</code> field in the access token response, the client
MUST use this key. Otherwise, the client MUST use the public key that
it specified in the <code>req_cnf</code> of the access token request. The client
MUST specify this public key in the SubjectPublicKeyInfo structure of
the DTLS handshake as described in <span>[<a href="#RFC7250" class="xref">RFC7250</a>]</span>.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">If the client does not have the keying material belonging to the
public key, the client MAY try to send an access token request to the
AS where it specifies its public key in the <code>req_cnf</code> parameter. If
the AS still specifies a public key in the response that the client
does not have, the client SHOULD re-register with the authorization
server to establish a new client public key. This process is out of
scope for this document.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2.2-3">To be consistent with <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>, which allows for shortened MAC tags
in constrained environments,
an implementation that supports the RPK mode of this profile MUST at
least support the cipher suite
TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8 <span>[<a href="#RFC7251" class="xref">RFC7251</a>]</span>.
As discussed in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>, new ECC
  curves have been defined recently that are considered superior to
  the so-called NIST curves. Implementations of this profile therefore
  MUST implement support for curve25519 (cf. <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>, <span>[<a href="#RFC8422" class="xref">RFC8422</a>]</span>)
  as this curve said to be efficient and less dangerous
  regarding implementation errors than the secp256r1 curve mandated in
  <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>.<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2.2-4">The resource server MUST check if the access token is still valid, if
the resource server is the intended destination (i.e., the audience)
of the token, and if the token was issued by an authorized
authorization server (see also section 5.10.1.1 of
<span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>).
The access token is constructed by the
authorization server such that the resource server can associate the
access token with the Client's public key.  The <code>cnf</code> claim MUST
contain either the client's RPK or, if the key is already known by the
resource server (e.g., from previous communication), a reference to
this key. If the authorization server has no certain knowledge that
the Client's key is already known to the resource server, the Client's
public key MUST be included in the access token's <code>cnf</code> parameter. If
CBOR web tokens <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span> are used (as recommended in
<span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>), keys MUST be encoded as specified in
<span>[<a href="#RFC8747" class="xref">RFC8747</a>]</span>. A resource server MUST have the capacity to store one
access token for every proof-of-possession key of every authorized client.<a href="#section-3.2.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2.2-5">The raw public key used in the DTLS handshake with the client MUST
belong to the resource server. If the resource server has several raw
public keys, it needs to determine which key to use. The authorization
server can help with this decision by including a <code>cnf</code> parameter in
the access token that is associated with this communication.  In this
case, the resource server MUST use the information from the <code>cnf</code>
field to select the proper keying material.<a href="#section-3.2.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2.2-6">Thus, the handshake only finishes if the client and the resource
server are able to use their respective keying material.<a href="#section-3.2.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="resource-access">
<section id="section-3.3">
        <h3 id="name-resource-access">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-resource-access" class="section-name selfRef">Resource Access</a>
        </h3>
<p id="section-3.3-1">Once a DTLS channel has been established as described in <a href="#rpk-mode" class="xref">Section 3.2</a>
 the client is authorized to access
resources covered by the access token it has uploaded to the
authz-info resource hosted by the resource server.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">With the successful establishment of the DTLS channel, the client and
the resource server have proven that they can use their respective
keying material. An access token that is bound to the client's keying
material is associated with the channel. According to Section 5.10.1 of
<span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, there should be only one access token
for each client. New access tokens issued by the authorization server
SHOULD replace previously issued access tokens for the
respective client. The resource server therefore needs a common
understanding with the authorization server how access tokens are
ordered. The authorization server may, e.g., specify a <code>cti</code> claim for
the access token (see Section 5.9.4 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>) to
employ a strict order.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">Any request that the resource server receives on a DTLS channel that
is tied to an access token via its keying material
MUST be checked against the authorization rules that can be determined
with the access token. The resource server
MUST check for every request if the access token is still valid.
If the token has expired, the resource server MUST remove it.
Incoming CoAP requests that are not authorized with respect
to any access token that is associated with the client MUST be
rejected by the resource server with 4.01 response. The response
SHOULD include AS Request Creation Hints as described in
Section 5.2 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">The resource server MUST NOT accept an incoming CoAP request as
authorized if any of the following fails:<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3-5">
<li id="section-3.3-5.1">The message was received on a secure channel that has been
established using the procedure defined in this document.<a href="#section-3.3-5.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-5.2">The authorization information tied to the sending client is valid.<a href="#section-3.3-5.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-5.3">The request is destined for the resource server.<a href="#section-3.3-5.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-5.4">The resource URI specified in the request is covered by the
authorization information.<a href="#section-3.3-5.4" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-5.5">The request method is an authorized action on the resource with
respect to the authorization information.<a href="#section-3.3-5.5" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.3-6">Incoming CoAP requests received on a secure DTLS channel that are not
thus authorized MUST be
rejected according to Section 5.10.1.1 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span><a href="#section-3.3-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3-7">
<li id="section-3.3-7.1">with response code 4.03 (Forbidden) when the resource URI specified
in the request is not covered by the authorization information, and<a href="#section-3.3-7.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-7.2">with response code 4.05 (Method Not Allowed) when the resource URI
specified in the request covered by the authorization information but
not the requested action.<a href="#section-3.3-7.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.3-8">The client MUST ascertain that its keying material is still valid
before sending a request or processing a response. If the client
recently has updated the access token (see <a href="#update" class="xref">Section 4</a>), it must be
prepared that its request is still handled according to the previous
authorization rules as there is no strict ordering between access
token uploads and resource access messages. See also
<a href="#multiple-access-tokens" class="xref">Section 8.2</a> for a discussion of access token
processing.<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<p id="section-3.3-9">If the client gets an error response
containing AS Request Creation Hints (cf.  Section 5.3 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>
as response to its requests, it SHOULD request a new access token from
the authorization server in order to continue communication with the
resource server.<a href="#section-3.3-9" class="pilcrow">¶</a></p>
<p id="section-3.3-10">Unauthorized requests that have been received over a DTLS session
SHOULD be treated as non-fatal by the resource server, i.e., the DTLS
session SHOULD be kept alive until the associated access token has
expired.<a href="#section-3.3-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="update">
<section id="section-4">
      <h2 id="name-dynamic-update-of-authoriza">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-dynamic-update-of-authoriza" class="section-name selfRef">Dynamic Update of Authorization Information</a>
      </h2>
<p id="section-4-1">Resource servers must only use a new access token to update the
authorization information for a DTLS session if the keying material
that is bound to the token is the same that was used in the DTLS
handshake. By associating the access tokens with the identifier of an
existing DTLS session, the authorization information can be updated
without changing the cryptographic keys for the DTLS communication
between the client and the resource server, i.e. an existing session
can be used with updated permissions.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The client can therefore update the authorization information stored at the
resource server at any time without changing an established DTLS
session. To do so, the client requests a
new access token from the authorization server
for the intended action on the respective resource
and uploads this access token to the authz-info resource on the
resource server.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3"><a href="#update-overview" class="xref">Figure 4</a> depicts the message flow where the client requests
a new access token after a security association between the client and
the resource server has been established using this protocol. If the
client wants to update the authorization information, the token
request MUST specify the key identifier of the proof-of-possession key
used for the existing DTLS channel between the client and the resource
server in the <code>kid</code> parameter of the Client-to-AS request. The
authorization server MUST verify that the specified <code>kid</code> denotes a
valid verifier for a proof-of-possession token that has previously
been issued to the requesting client. Otherwise, the Client-to-AS
request MUST be declined with the error code <code>unsupported_pop_key</code> as
defined in Section 5.8.3 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">When the authorization server issues a new access token to update
existing authorization information, it MUST include the specified <code>kid</code>
parameter in this access token. A resource server MUST replace the
authorization information of any existing DTLS session that is identified
by this key identifier with the updated authorization information.<a href="#section-4-4" class="pilcrow">¶</a></p>
<span id="name-overview-of-dynamic-update-"></span><div id="update-overview">
<figure id="figure-4">
        <div class="alignLeft art-text artwork" id="section-4-5.1">
<pre>
   C                            RS                   AS
   | &lt;===== DTLS channel =====&gt; |                     |
   |        + Access Token      |                     |
   |                            |                     |
   | --- Token Request  ----------------------------&gt; |
   |                            |                     |
   | &lt;---------------------------- New Access Token - |
   |                           + Access Information   |
   |                            |                     |
   | --- Update /authz-info --&gt; |                     |
   |     New Access Token       |                     |
   |                            |                     |
   | == Authorized Request ===&gt; |                     |
   |                            |                     |
   | &lt;=== Protected Resource == |                     |

</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-overview-of-dynamic-update-" class="selfRef">Overview of Dynamic Update Operation</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="teardown">
<section id="section-5">
      <h2 id="name-token-expiration">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-token-expiration" class="section-name selfRef">Token Expiration</a>
      </h2>
<p id="section-5-1">The resource server MUST delete access tokens that are no longer
valid.  DTLS associations that have been setup in accordance with
this profile are always tied to specific tokens (which may be
exchanged with a dynamic update as described in Section 4). As tokens
may become invalid at any time (e.g., because they have expired), the
association may become useless at some point.  A resource server therefore
MUST terminate existing DTLS association after the last access token
associated with this association has expired.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">As specified in Section 5.10.3 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>,
the resource server MUST notify the client with an error response with
code 4.01 (Unauthorized) for any long running request before
terminating the association.<a href="#section-5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="as-commsec">
<section id="section-6">
      <h2 id="name-secure-communication-with-a">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-secure-communication-with-a" class="section-name selfRef">Secure Communication with an Authorization Server</a>
      </h2>
<p id="section-6-1">As specified in the ACE framework (Sections 5.8 and 5.9 of
<span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>), the requesting entity (the resource
server and/or the client) and the authorization server communicate via
the token endpoint or introspection endpoint.  The use of CoAP and
DTLS for this communication is RECOMMENDED in this profile. Other
protocols fulfilling the security requirements defined in Section 5
of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> MAY be used instead.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">How credentials (e.g., RPK, X.509 cert) for using DTLS with the
authorization server are established is out of scope for this profile.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">If other means of securing the communication with the authorization
server are used, the communication security requirements from Section
6.2 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> remain applicable.<a href="#section-6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-edhoc-params">
<section id="section-7">
      <h2 id="name-edhoc-application-profile-p">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-edhoc-application-profile-p" class="section-name selfRef">EDHOC Application Profile Parameters</a>
      </h2>
<p id="section-7-1">This specification defines a number of EDHOC application profile parameters that can be transported in the 'edhoc_params' parameter of a Token Response to the Client, or in the 'edhoc_params' claim of an access token.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">In the former case, when the response payload is encoded as a CBOR map, the response MUST use the Content-Format "application/ace+cbor" defined in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">The table below summarizes them, and specifies the CBOR value to use as abbreviation instead of the full descriptive name.<a href="#section-7-3" class="pilcrow">¶</a></p>
<span id="name-cbor-abbreviations-for-the-"></span><div id="fig-cbor-key-edhoc-params">
<figure id="figure-5">
        <div class="alignCenter art-text artwork" id="section-7-4.1">
<pre>
+--------------+------+--------------+----------+---------------------+
| Name         | CBOR | CBOR value   | Registry | Description         |
|              | Type |              |          |                     |
+--------------+------+--------------+----------+---------------------+
| id           | TBD  | bstr         |          | EDHOC session       |
|              |      |              |          | identifier          |
+--------------+------+--------------+----------+---------------------+
| methods      | TBD  | int / array  | EDHOC    | EDHOC methods       |
|              |      |              | Method   | possible to use     |
|              |      |              | Type     | between the Client  |
|              |      |              | Registry | and RS              |
+--------------+------+--------------+----------+---------------------+
| cipher_suite | TBD  | int          | EDHOC    | The EDHOC cipher    |
|              |      |              | Cipher   | suite to use as     |
|              |      |              | Suites   | selected cipher     |
|              |      |              | Registry | suite               |
+--------------+------+--------------+----------+---------------------+
| osc_ms_len   | TBD  | uint         |          | Length in bytes of  |
|              |      |              |          | the OSCORE Master   |
|              |      |              |          | Secret to derive    |
|              |      |              |          | with EDHOC-Exporter |
+--------------+------+--------------+----------+---------------------+
| osc_salt_len | TBD  | uint         |          | Length in bytes of  |
|              |      |              |          | the OSCORE Master   |
|              |      |              |          | Salt to derive      |
|              |      |              |          | with EDHOC-Exporter |
+--------------+------+--------------+----------+---------------------+
| key_update   | TBD  | simple value |          | Indication on the   |
|              |      | "true" /     |          | RS support for      |
|              |      | simple value |          | EDHOC-KeyUpdate     |
|              |      | "false"      |          |                     |
+--------------+------+--------------+----------+---------------------+
| message_4    | TBD  | simple value |          | Indication on the   |
|              |      | "true" /     |          | RS support for      |
|              |      | simple value |          | EDHOC message_4     |
+--------------+------+--------------+----------+---------------------+
| comb_req     | TBD  | simple value |          | Indication on the   |
|              |      | "true" /     |          | RS support for the  |
|              |      | simple value |          | EDHOC+OSCORE        |
|              |      | "false"      |          | combined request    |
+--------------+------+--------------+----------+---------------------+
| uri_path     | TBD  | tstr         |          | URI-path of the     |
|              |      |              |          | EDHOC resource at   |
|              |      |              |          | the RS              |
+--------------+------+--------------+----------+---------------------+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-cbor-abbreviations-for-the-" class="selfRef">CBOR abbreviations for the EDHOC application profile parameters</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">This document specifies a profile for the Authentication and
Authorization for Constrained Environments (ACE) framework
<span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. As it follows this framework's general
approach, the general security considerations from Section
6 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> also apply to this profile.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The authorization server must ascertain that the keying material for
the client that it provides to the resource server actually is
associated with this client.  Malicious clients may hand over access
tokens containing their own access permissions to other entities. This
problem cannot be completely eliminated. Nevertheless, in RPK mode it
should not be possible for clients to request access tokens for
arbitrary public keys: if the client can cause the authorization
server to issue a token for a public key without proving possession of
the corresponding private key, this allows for identity misbinding
attacks where the issued token is usable by an entity other than the
intended one.  The authorization server therefore at some point needs
to validate that the client can actually use the private key
corresponding to the client's public key.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">Constrained devices that use DTLS <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span> are inherently
vulnerable to Denial of Service (DoS) attacks as the handshake
protocol requires creation of internal state within the device.  This
is specifically of concern where an adversary is able to intercept the
initial cookie exchange and interject forged messages with a valid
cookie to continue with the handshake. A similar issue exists with the
unprotected authorization information endpoint when the resource
server needs to keep valid access tokens for a long time. Adversaries
could fill up the constrained resource server's internal storage for a
very long time with interjected or otherwise retrieved valid access
tokens.  To mitigate against this, the resource server should set a
time boundary until an access token that has not been used until then
will be deleted.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">The protection of access tokens that are stored in the authorization
information endpoint depends on the keying material that is used between
the authorization server and the resource server: The resource server
must ensure that it processes only access tokens that are (encrypted
and) integrity-protected by an authorization server that is authorized
to provide access tokens for the resource server.<a href="#section-8-4" class="pilcrow">¶</a></p>
<div id="reuse-of-existing-sessions">
<section id="section-8.1">
        <h3 id="name-reuse-of-existing-sessions">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-reuse-of-existing-sessions" class="section-name selfRef">Reuse of Existing Sessions</a>
        </h3>
<p id="section-8.1-1">To avoid the overhead of a repeated DTLS handshake, <span>[<a href="#RFC7925" class="xref">RFC7925</a>]</span>
recommends session resumption <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> to reuse session state from
an earlier DTLS association and thus requires client side
implementation.  In this specification, the DTLS session is subject to
the authorization rules denoted by the access token that was used for
the initial setup of the DTLS association. Enabling session resumption
would require the server to transfer the authorization information
with the session state in an encrypted SessionTicket to the
client. Assuming that the server uses long-lived keying material, this
could open up attacks due to the lack of forward secrecy. Moreover,
using this mechanism, a client can resume a DTLS session without
proving the possession of the PoP key again. Therefore, session
resumption should be used only in combination with reasonably
short-lived PoP keys.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Since renegotiation of DTLS associations is prone to attacks as well,
<span>[<a href="#RFC7925" class="xref">RFC7925</a>]</span> requires clients to decline any renegotiation attempt. A
server that wants to initiate re-keying therefore SHOULD periodically
force a full handshake.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multiple-access-tokens">
<section id="section-8.2">
        <h3 id="name-multiple-access-tokens">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-multiple-access-tokens" class="section-name selfRef">Multiple Access Tokens</a>
        </h3>
<p id="section-8.2-1">Developers SHOULD avoid using multiple access tokens for a
client (see also section 5.10.1 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>).<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">Even when a single access token per client is used, an attacker could
compromise the dynamic update mechanism for existing DTLS connections
by delaying or reordering packets destined for the authz-info
endpoint. Thus, the order in which operations occur at the resource
server (and thus which authorization info is used to process a given
client request) cannot be guaranteed.  Especially in the presence of
later-issued access tokens that reduce the client's permissions from
the initial access token, it is impossible to guarantee that the
reduction in authorization will take effect prior to the expiration of
the original token.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="out-of-band-configuration">
<section id="section-8.3">
        <h3 id="name-out-of-band-configuration">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-out-of-band-configuration" class="section-name selfRef">Out-of-Band Configuration</a>
        </h3>
<p id="section-8.3-1">To communicate securely, the authorization server, the client and the
resource server require certain information that must be exchanged
outside the protocol flow described in this document. The
authorization server must have obtained authorization information
concerning the client and the resource server that is approved by the
resource owner as well as corresponding keying material. The resource
server must have received authorization information approved by the
resource owner concerning its authorization managers and the
respective keying material. The client must have obtained
authorization information concerning the authorization server approved
by its owner as well as the corresponding keying material. Also, the
client's owner must have approved of the client's communication with
the resource server. The client and the authorization server must have
obtained a common understanding how this resource server is identified
to ensure that the client obtains access token and keying material for
the correct resource server. If the client is provided with a raw
public key for the resource server, it must be ascertained to which
resource server (which identifier and authorization information) the
key is associated.  All authorization information and keying material
must be kept up to date.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-9">
      <h2 id="name-privacy-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-9-1">This privacy considerations from Section
7 of the <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> apply also to this profile.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">An unprotected response to an unauthorized request may disclose
information about the resource server and/or its existing relationship
with the client. It is advisable to include as little information as
possible in an unencrypted response. When a DTLS session between an authenticated
client and the resource server already exists, more detailed
information MAY be included with an error response to provide the
client with sufficient information to react on that particular error.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">Also, unprotected requests to the resource server may reveal
information about the client, e.g., which resources the client
attempts to request or the data that the client wants to provide to
the resource server. The client SHOULD NOT send confidential data in
an unprotected request.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">Note that some information might still leak after DTLS session is
established, due to observable message sizes, the source, and the
destination addresses.<a href="#section-9-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document has the following actions for IANA.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Note to RFC Editor: Please replace all occurrences of "[RFC-XXXX]" with
the RFC number of this specification and delete this paragraph.<a href="#section-10-2" class="pilcrow">¶</a></p>
<div id="iana-ace-oauth-profile">
<section id="section-10.1">
        <h3 id="name-ace-oauth-profile-registry">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-ace-oauth-profile-registry" class="section-name selfRef">ACE OAuth Profile Registry</a>
        </h3>
<p id="section-10.1-1">IANA is asked to add the following entry to the "ACE OAuth Profile"
Registry following the procedure specified in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-2.1">Profile name: coap_edhoc_oscore<a href="#section-10.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.1-2.2">Profile Description: Profile for delegating client authentication and
authorization in a constrained environment by establishing an OSCORE Security Context <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> between resource-constrained nodes, through the execution of the authenticated key establishment protocol EDHOC <span>[<a href="#I-D.ietf-core-oscore-edhoc" class="xref">I-D.ietf-core-oscore-edhoc</a>]</span>.<a href="#section-10.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.1-2.3">Profile ID:  TBD (value between 1 and 255)<a href="#section-10.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.1-2.4">Change Controller: IESG<a href="#section-10.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.1-2.5">Reference:  [RFC-XXXX]<a href="#section-10.1-2.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-oauth-params">
<section id="section-10.2">
        <h3 id="name-oauth-parameters-registry">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-oauth-parameters-registry" class="section-name selfRef">OAuth Parameters Registry</a>
        </h3>
<p id="section-10.2-1">IANA is asked to add the following entries to the "OAuth Parameters" registry.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-2.1">Name: "edhoc_params"<a href="#section-10.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.2-2.2">Parameter Usage Location: token response<a href="#section-10.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.2-2.3">Change Controller: IESG<a href="#section-10.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.2-2.4">Specification Document(s): [RFC-XXXX]<a href="#section-10.2-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.2-3"></p>
<ul class="normal">
<li class="normal" id="section-10.2-4.1">Name: "token_uploaded"<a href="#section-10.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.2-4.2">Parameter Usage Location: token response<a href="#section-10.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.2-4.3">Change Controller: IESG<a href="#section-10.2-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.2-4.4">Specification Document(s): [RFC-XXXX]<a href="#section-10.2-4.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-token-cbor-mappings">
<section id="section-10.3">
        <h3 id="name-oauth-parameters-cbor-mappi">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-oauth-parameters-cbor-mappi" class="section-name selfRef">OAuth Parameters CBOR Mappings Registry</a>
        </h3>
<p id="section-10.3-1">IANA is asked to add the following entries to the "OAuth Parameters CBOR Mappings" following the procedure specified in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.3-2.1">Name: "edhoc_params"<a href="#section-10.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.3-2.2">CBOR Key: TBD<a href="#section-10.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.3-2.3">Value Type: map<a href="#section-10.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.3-2.4">Specification Document(s): [RFC-XXXX]<a href="#section-10.3-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.3-3"></p>
<ul class="normal">
<li class="normal" id="section-10.3-4.1">Name: "token_uploaded"<a href="#section-10.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.3-4.2">CBOR Key: TBD<a href="#section-10.3-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.3-4.3">Value Type: simple value "true" / simple type "false"<a href="#section-10.3-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.3-4.4">Specification Document(s): [RFC-XXXX]<a href="#section-10.3-4.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-token-json-claims">
<section id="section-10.4">
        <h3 id="name-json-web-token-claims-regis">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-json-web-token-claims-regis" class="section-name selfRef">JSON Web Token Claims Registry</a>
        </h3>
<p id="section-10.4-1">IANA is asked to add the following entries to the "JSON Web Token Claims" registry following the procedure specified in <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span>.<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.4-2.1">Claim Name: "edhoc_params"<a href="#section-10.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.4-2.2">Claim Description: Parameters of the EDHOC application profile to use<a href="#section-10.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.4-2.3">Change Controller: IETF<a href="#section-10.4-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.4-2.4">Reference: [RFC-XXXX]<a href="#section-10.4-2.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-token-cwt-claims">
<section id="section-10.5">
        <h3 id="name-cbor-web-token-claims-regis">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-cbor-web-token-claims-regis" class="section-name selfRef">CBOR Web Token Claims Registry</a>
        </h3>
<p id="section-10.5-1">IANA is asked to add the following entries to the "CBOR Web Token Claims" registry following the procedure specified in <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span>.<a href="#section-10.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.5-2.1">Claim Name: "edhoc_params"<a href="#section-10.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.5-2.2">Claim Description: Parameters of the EDHOC application profile to use<a href="#section-10.5-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.5-2.3">JWT Claim Name: "edhoc_params"<a href="#section-10.5-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.5-2.4">Claim Key: TBD<a href="#section-10.5-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.5-2.5">Claim Value Type(s): map<a href="#section-10.5-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.5-2.6">Change Controller: IESG<a href="#section-10.5-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.5-2.7">Specification Document(s): [RFC-XXXX]<a href="#section-10.5-2.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-jwt-confirmation-methods">
<section id="section-10.6">
        <h3 id="name-jwt-confirmation-methods-re">
<a href="#section-10.6" class="section-number selfRef">10.6. </a><a href="#name-jwt-confirmation-methods-re" class="section-name selfRef">JWT Confirmation Methods Registry</a>
        </h3>
<p id="section-10.6-1">IANA is asked to add the following entries to the "JWT Confirmation Methods" registry following the procedure specified in <span>[<a href="#RFC7800" class="xref">RFC7800</a>]</span>.<a href="#section-10.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.6-2.1">Confirmation Method Value: "x5bag"<a href="#section-10.6-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-2.2">Confirmation Method Description: An unordered bag of X.509 certificates<a href="#section-10.6-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-2.3">Change Controller: IESG<a href="#section-10.6-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-2.4">Specification Document(s): [RFC-XXXX]<a href="#section-10.6-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.6-3"></p>
<ul class="normal">
<li class="normal" id="section-10.6-4.1">Confirmation Method Value: "x5chain"<a href="#section-10.6-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-4.2">Confirmation Method Description: An ordered chain of X.509 certificates<a href="#section-10.6-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-4.3">Change Controller: IESG<a href="#section-10.6-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-4.4">Specification Document(s): [RFC-XXXX]<a href="#section-10.6-4.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.6-5"></p>
<ul class="normal">
<li class="normal" id="section-10.6-6.1">Confirmation Method Value: "x5t"<a href="#section-10.6-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-6.2">Confirmation Method Description: Hash of an X.509 certificate<a href="#section-10.6-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-6.3">Change Controller: IESG<a href="#section-10.6-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-6.4">Specification Document(s): [RFC-XXXX]<a href="#section-10.6-6.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.6-7"></p>
<ul class="normal">
<li class="normal" id="section-10.6-8.1">Confirmation Method Value: "x5u"<a href="#section-10.6-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-8.2">Confirmation Method Description: URI pointing to an X.509 certificate<a href="#section-10.6-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-8.3">Change Controller: IESG<a href="#section-10.6-8.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-8.4">Specification Document(s): [RFC-XXXX]<a href="#section-10.6-8.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.6-9"></p>
<ul class="normal">
<li class="normal" id="section-10.6-10.1">Confirmation Method Value: "c5b"<a href="#section-10.6-10.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-10.2">Confirmation Method Description: An unordered bag of C509 certificates<a href="#section-10.6-10.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-10.3">Change Controller: IESG<a href="#section-10.6-10.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-10.4">Specification Document(s): [RFC-XXXX]<a href="#section-10.6-10.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.6-11"></p>
<ul class="normal">
<li class="normal" id="section-10.6-12.1">Confirmation Method Value: "c5c"<a href="#section-10.6-12.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-12.2">Confirmation Method Description: An ordered chain of C509 certificates<a href="#section-10.6-12.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-12.3">Change Controller: IESG<a href="#section-10.6-12.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-12.4">Specification Document(s): [RFC-XXXX]<a href="#section-10.6-12.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.6-13"></p>
<ul class="normal">
<li class="normal" id="section-10.6-14.1">Confirmation Method Value: "c5t"<a href="#section-10.6-14.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-14.2">Confirmation Method Description: Hash of an C509 certificate<a href="#section-10.6-14.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-14.3">Change Controller: IESG<a href="#section-10.6-14.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-14.4">Specification Document(s): [RFC-XXXX]<a href="#section-10.6-14.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.6-15"></p>
<ul class="normal">
<li class="normal" id="section-10.6-16.1">Confirmation Method Value: "c5u"<a href="#section-10.6-16.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-16.2">Confirmation Method Description: URI pointing to a COSE_C509 containing an ordere chain of certificates<a href="#section-10.6-16.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-16.3">Change Controller: IESG<a href="#section-10.6-16.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-16.4">Specification Document(s): [RFC-XXXX]<a href="#section-10.6-16.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.6-17"></p>
<ul class="normal">
<li class="normal" id="section-10.6-18.1">Confirmation Method Value: "kcwt"<a href="#section-10.6-18.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-18.2">Confirmation Method Description: A CBOR Web Token (CWT) containing a COSE_Key in a 'cnf' claim<a href="#section-10.6-18.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-18.3">Change Controller: IESG<a href="#section-10.6-18.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-18.4">Specification Document(s): [RFC-XXXX]<a href="#section-10.6-18.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.6-19"></p>
<ul class="normal">
<li class="normal" id="section-10.6-20.1">Confirmation Method Value: "kccs"<a href="#section-10.6-20.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-20.2">Confirmation Method Description: A CWT Claims Set (CCS) containing a COSE_Key in a 'cnf' claim<a href="#section-10.6-20.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-20.3">Change Controller: IESG<a href="#section-10.6-20.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.6-20.4">Specification Document(s): [RFC-XXXX]<a href="#section-10.6-20.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.6-21"></p>
</section>
</div>
<div id="iana-cwt-confirmation-methods">
<section id="section-10.7">
        <h3 id="name-cwt-confirmation-methods-re">
<a href="#section-10.7" class="section-number selfRef">10.7. </a><a href="#name-cwt-confirmation-methods-re" class="section-name selfRef">CWT Confirmation Methods Registry</a>
        </h3>
<p id="section-10.7-1">IANA is asked to add the following entries to the "CWT Confirmation Methods" registry following the procedure specified in <span>[<a href="#RFC8747" class="xref">RFC8747</a>]</span>.<a href="#section-10.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.7-2.1">Confirmation Method Name: x5bag<a href="#section-10.7-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-2.2">Confirmation Method Description: An unordered bag of X.509 certificates<a href="#section-10.7-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-2.3">JWT Confirmation Method Name: "x5bag"<a href="#section-10.7-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-2.4">Confirmation Key: TBD<a href="#section-10.7-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-2.5">Confirmation Value Type(s): COSE_X509<a href="#section-10.7-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-2.6">Change Controller: IESG<a href="#section-10.7-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-2.7">Specification Document(s): [RFC-XXXX]<a href="#section-10.7-2.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.7-3"></p>
<ul class="normal">
<li class="normal" id="section-10.7-4.1">Confirmation Method Name: x5chain<a href="#section-10.7-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-4.2">Confirmation Method Description: An ordered chain of X.509 certificates<a href="#section-10.7-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-4.3">JWT Confirmation Method Name: "x5chain"<a href="#section-10.7-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-4.4">Confirmation Key: TBD<a href="#section-10.7-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-4.5">Confirmation Value Type(s): COSE_X509<a href="#section-10.7-4.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-4.6">Change Controller: IESG<a href="#section-10.7-4.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-4.7">Specification Document(s): [RFC-XXXX]<a href="#section-10.7-4.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.7-5"></p>
<ul class="normal">
<li class="normal" id="section-10.7-6.1">Confirmation Method Name: x5t<a href="#section-10.7-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-6.2">Confirmation Method Description: Hash of an X.509 certificate<a href="#section-10.7-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-6.3">JWT Confirmation Method Name: "x5t"<a href="#section-10.7-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-6.4">Confirmation Key: TBD<a href="#section-10.7-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-6.5">Confirmation Value Type(s): COSE_CertHash<a href="#section-10.7-6.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-6.6">Change Controller: IESG<a href="#section-10.7-6.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-6.7">Specification Document(s): [RFC-XXXX]<a href="#section-10.7-6.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.7-7"></p>
<ul class="normal">
<li class="normal" id="section-10.7-8.1">Confirmation Method Name: x5u<a href="#section-10.7-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-8.2">Confirmation Method Description: URI pointing to an X.509 certificate<a href="#section-10.7-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-8.3">JWT Confirmation Method Name: "x5u"<a href="#section-10.7-8.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-8.4">Confirmation Key: TBD<a href="#section-10.7-8.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-8.5">Confirmation Value Type(s): uri<a href="#section-10.7-8.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-8.6">Change Controller: IESG<a href="#section-10.7-8.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-8.7">Specification Document(s): [RFC-XXXX]<a href="#section-10.7-8.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.7-9"></p>
<ul class="normal">
<li class="normal" id="section-10.7-10.1">Confirmation Method Name: c5b<a href="#section-10.7-10.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-10.2">Confirmation Method Description: An unordered bag of C509 certificates<a href="#section-10.7-10.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-10.3">JWT Confirmation Method Name: "c5b"<a href="#section-10.7-10.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-10.4">Confirmation Key: TBD<a href="#section-10.7-10.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-10.5">Confirmation Value Type(s): COSE_C509<a href="#section-10.7-10.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-10.6">Change Controller: IESG<a href="#section-10.7-10.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-10.7">Specification Document(s): [RFC-XXXX]<a href="#section-10.7-10.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.7-11"></p>
<ul class="normal">
<li class="normal" id="section-10.7-12.1">Confirmation Method Name: c5c<a href="#section-10.7-12.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-12.2">Confirmation Method Description: An ordered chain of C509 certificates<a href="#section-10.7-12.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-12.3">JWT Confirmation Method Name: "c5c"<a href="#section-10.7-12.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-12.4">Confirmation Key: TBD<a href="#section-10.7-12.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-12.5">Confirmation Value Type(s): COSE_C509<a href="#section-10.7-12.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-12.6">Change Controller: IESG<a href="#section-10.7-12.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-12.7">Specification Document(s): [RFC-XXXX]<a href="#section-10.7-12.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.7-13"></p>
<ul class="normal">
<li class="normal" id="section-10.7-14.1">Confirmation Method Name: c5t<a href="#section-10.7-14.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-14.2">Confirmation Method Description: Hash of an C509 certificate<a href="#section-10.7-14.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-14.3">JWT Confirmation Method Name: "c5t"<a href="#section-10.7-14.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-14.4">Confirmation Key: TBD<a href="#section-10.7-14.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-14.5">Confirmation Value Type(s): COSE_CertHash<a href="#section-10.7-14.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-14.6">Change Controller: IESG<a href="#section-10.7-14.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-14.7">Specification Document(s): [RFC-XXXX]<a href="#section-10.7-14.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.7-15"></p>
<ul class="normal">
<li class="normal" id="section-10.7-16.1">Confirmation Method Name: c5u<a href="#section-10.7-16.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-16.2">Confirmation Method Description: URI pointing to a COSE_C509 containing an ordere chain of certificates<a href="#section-10.7-16.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-16.3">JWT Confirmation Method Name: "c5u"<a href="#section-10.7-16.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-16.4">Confirmation Key: TBD<a href="#section-10.7-16.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-16.5">Confirmation Value Type(s): uri<a href="#section-10.7-16.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-16.6">Change Controller: IESG<a href="#section-10.7-16.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-16.7">Specification Document(s): [RFC-XXXX]<a href="#section-10.7-16.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.7-17"></p>
<ul class="normal">
<li class="normal" id="section-10.7-18.1">Confirmation Method Name: kcwt<a href="#section-10.7-18.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-18.2">Confirmation Method Description: A CBOR Web Token (CWT) containing a COSE_Key in a 'cnf' claim<a href="#section-10.7-18.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-18.3">JWT Confirmation Method Name: "kcwt"<a href="#section-10.7-18.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-18.4">Confirmation Key: TBD<a href="#section-10.7-18.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-18.5">Confirmation Value Type(s): COSE_Messages<a href="#section-10.7-18.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-18.6">Change Controller: IESG<a href="#section-10.7-18.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-18.7">Specification Document(s): [RFC-XXXX]<a href="#section-10.7-18.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.7-19"></p>
<ul class="normal">
<li class="normal" id="section-10.7-20.1">Confirmation Method Name: kccs<a href="#section-10.7-20.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-20.2">Confirmation Method Description: A CWT Claims Set (CCS) containing a COSE_Key in a 'cnf' claim<a href="#section-10.7-20.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-20.3">JWT Confirmation Method Name: "kccs"<a href="#section-10.7-20.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-20.4">Confirmation Key: TBD<a href="#section-10.7-20.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-20.5">Confirmation Value Type(s): map / #6(map)<a href="#section-10.7-20.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-20.6">Change Controller: IESG<a href="#section-10.7-20.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.7-20.7">Specification Document(s): [RFC-XXXX]<a href="#section-10.7-20.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-edhoc-parameters">
<section id="section-10.8">
        <h3 id="name-edhoc-application-profile-pa">
<a href="#section-10.8" class="section-number selfRef">10.8. </a><a href="#name-edhoc-application-profile-pa" class="section-name selfRef">EDHOC Application Profile Parameters Registry</a>
        </h3>
<p id="section-10.8-1">It is requested that IANA create a new registry entitled "EDHOC Application Profile Parameters" registry. The registry is to be created with registration policy Expert Review <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Guidelines for the experts are provided in <a href="#iana-expert-review" class="xref">Section 10.9</a>. It should be noted that in addition to the expert review, some portions of the registry require a specification, potentially on Standards Track, be supplied as well.<a href="#section-10.8-1" class="pilcrow">¶</a></p>
<p id="section-10.8-2">The columns of the registry are:<a href="#section-10.8-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.8-3.1">
            <p id="section-10.8-3.1.1">Name: A descriptive name that enables easier reference to this item. Because a core goal of this document is for the resulting representations to be compact, it is RECOMMENDED that the name be short.<a href="#section-10.8-3.1.1" class="pilcrow">¶</a></p>
<p id="section-10.8-3.1.2">
This name is case sensitive. Names may not match other registered names in a case-insensitive manner unless the Designated Experts determine that there is a compelling reason to allow an exception. The name is not used in the CBOR encoding.<a href="#section-10.8-3.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.8-3.2">
            <p id="section-10.8-3.2.1">CBOR Value: The value to be used as CBOR abbreviation of the item.<a href="#section-10.8-3.2.1" class="pilcrow">¶</a></p>
<p id="section-10.8-3.2.2">
The value MUST be unique. The value can be a positive integer, a negative integer or a string. Integer values between -256 and 255 and strings of length 1 are to be registered by Standards Track documents (Standards Action). Integer values from -65536 to -257 and from 256 to 65535 and strings of maximum length 2 are to be registered by public specifications (Specification Required). Integer values greater than 65535 and strings of length greater than 2 are subject to the Expert Review policy. Integer values less than -65536 are marked as private use.<a href="#section-10.8-3.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.8-3.3">CBOR Type: The CBOR type of the item, or a pointer to the registry that defines its type, when that depends on another item.<a href="#section-10.8-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.8-3.4">Registry: The registry that values of the item may come from, if one exists.<a href="#section-10.8-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.8-3.5">Description: A brief description of this item.<a href="#section-10.8-3.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.8-3.6">Specification: A pointer to the public specification for the item, if one exists.<a href="#section-10.8-3.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.8-4">This registry will be initially populated by the values in <a href="#key-edhoc-params" class="xref">Section 7</a>. The "Specification" column for all of these entries will be this document and <span>[<a href="#I-D.ietf-core-oscore-edhoc" class="xref">I-D.ietf-core-oscore-edhoc</a>]</span>.<a href="#section-10.8-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-expert-review">
<section id="section-10.9">
        <h3 id="name-expert-review-instructions">
<a href="#section-10.9" class="section-number selfRef">10.9. </a><a href="#name-expert-review-instructions" class="section-name selfRef">Expert Review Instructions</a>
        </h3>
<p id="section-10.9-1">The IANA registry established in this document is defined to use the registration policy Expert Review. This section gives some general guidelines for what the experts should be looking for, but they are being designated as experts for a reason so they should be given substantial latitude.<a href="#section-10.9-1" class="pilcrow">¶</a></p>
<p id="section-10.9-2">Expert reviewers should take into consideration the following points:<a href="#section-10.9-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.9-3.1">Point squatting should be discouraged. Reviewers are encouraged to get sufficient information for registration requests to ensure that the usage is not going to duplicate one that is already registered and that the point is likely to be used in deployments. The zones tagged as private use are intended for testing purposes and closed environments; code points in other ranges should not be assigned for testing.<a href="#section-10.9-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.9-3.2">Specifications are required for the Standards Action range of point assignment. Specifications should exist for Specification Required ranges, but early assignment before a specification is available is considered to be permissible. Specifications are needed for the first-come, first-serve range if they are expected to be used outside of closed environments in an interoperable way. When specifications are not provided, the description provided needs to have sufficient information to identify what the point is being used for.<a href="#section-10.9-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.9-3.3">Experts should take into account the expected usage of fields when approving point assignment. The fact that there is a range for Standards Track documents does not mean that a Standards Track document cannot have points assigned outside of that range. The length of the encoded value should be weighed against how many code points of that length are left, the size of device it will be used on, and the number of code points left that encode to that size.<a href="#section-10.9-3.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-oauth-authz">[I-D.ietf-ace-oauth-authz]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments (ACE) using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oauth-authz-46</span>, <time datetime="2021-11-08" class="refDate">8 November 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46">https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oauth-params">[I-D.ietf-ace-oauth-params]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refTitle">"Additional OAuth Parameters for Authorization in Constrained Environments (ACE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oauth-params-16</span>, <time datetime="2021-09-07" class="refDate">7 September 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-params-16">https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-params-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-edhoc">[I-D.ietf-core-oscore-edhoc]</dt>
        <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Hoeglund, R.</span>, <span class="refAuthor">Hristozov, S.</span>, and <span class="refAuthor">G. Selander</span>, <span class="refTitle">"Profiling EDHOC for CoAP and OSCORE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-edhoc-03</span>, <time datetime="2022-03-07" class="refDate">7 March 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-edhoc-03">https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-edhoc-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-cbor-encoded-cert">[I-D.ietf-cose-cbor-encoded-cert]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">Höglund, J.</span>, and <span class="refAuthor">M. Furuhed</span>, <span class="refTitle">"CBOR Encoded X.509 Certificates (C509 Certificates)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-cbor-encoded-cert-03</span>, <time datetime="2022-01-10" class="refDate">10 January 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-03">https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-x509">[I-D.ietf-cose-x509]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Header parameters for carrying and referencing X.509 certificates"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-x509-08</span>, <time datetime="2020-12-14" class="refDate">14 December 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-x509-08">https://datatracker.ietf.org/doc/html/draft-ietf-cose-x509-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lake-edhoc">[I-D.ietf-lake-edhoc]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J. P.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lake-edhoc-14</span>, <time datetime="2022-05-18" class="refDate">18 May 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-14">https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6347">https://www.rfc-editor.org/rfc/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7250">[RFC7250]</dt>
        <dd>
<span class="refAuthor">Wouters, P., Ed.</span>, <span class="refAuthor">Tschofenig, H., Ed.</span>, <span class="refAuthor">Gilmore, J.</span>, <span class="refAuthor">Weiler, S.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7250</span>, <span class="seriesInfo">DOI 10.17487/RFC7250</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7250">https://www.rfc-editor.org/rfc/rfc7250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7251">[RFC7251]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Bailey, D.</span>, <span class="refAuthor">Campagna, M.</span>, and <span class="refAuthor">R. Dugal</span>, <span class="refTitle">"AES-CCM Elliptic Curve Cryptography (ECC) Cipher Suites for TLS"</span>, <span class="seriesInfo">RFC 7251</span>, <span class="seriesInfo">DOI 10.17487/RFC7251</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7251">https://www.rfc-editor.org/rfc/rfc7251</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7800">[RFC7800]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for JSON Web Tokens (JWTs)"</span>, <span class="seriesInfo">RFC 7800</span>, <span class="seriesInfo">DOI 10.17487/RFC7800</span>, <time datetime="2016-04" class="refDate">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7800">https://www.rfc-editor.org/rfc/rfc7800</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7925">[RFC7925]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H., Ed.</span> and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things"</span>, <span class="seriesInfo">RFC 7925</span>, <span class="seriesInfo">DOI 10.17487/RFC7925</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7925">https://www.rfc-editor.org/rfc/rfc7925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8152">[RFC8152]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE)"</span>, <span class="seriesInfo">RFC 8152</span>, <span class="seriesInfo">DOI 10.17487/RFC8152</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8152">https://www.rfc-editor.org/rfc/rfc8152</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8422">[RFC8422]</dt>
        <dd>
<span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Josefsson, S.</span>, and <span class="refAuthor">M. Pegourie-Gonnard</span>, <span class="refTitle">"Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS) Versions 1.2 and Earlier"</span>, <span class="seriesInfo">RFC 8422</span>, <span class="seriesInfo">DOI 10.17487/RFC8422</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8422">https://www.rfc-editor.org/rfc/rfc8422</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8613">https://www.rfc-editor.org/rfc/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8747">https://www.rfc-editor.org/rfc/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-oscore-profile">[I-D.ietf-ace-oscore-profile]</dt>
        <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">M. Gunnarsson</span>, <span class="refTitle">"OSCORE Profile of the Authentication and Authorization for Constrained Environments Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oscore-profile-19</span>, <time datetime="2021-05-06" class="refDate">6 May 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19">https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5869">https://www.rfc-editor.org/rfc/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7662">[RFC7662]</dt>
        <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refTitle">"OAuth 2.0 Token Introspection"</span>, <span class="seriesInfo">RFC 7662</span>, <span class="seriesInfo">DOI 10.17487/RFC7662</span>, <time datetime="2015-10" class="refDate">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7662">https://www.rfc-editor.org/rfc/rfc7662</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7748">https://www.rfc-editor.org/rfc/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8032">https://www.rfc-editor.org/rfc/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9147">https://www.rfc-editor.org/rfc/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="examples">
<section id="appendix-A">
      <h2 id="name-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="appendix-A-1">This appendix provides examples where this profile of ACE is used. In particular:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">
          <a href="#example-without-optimization" class="xref">Appendix A.1</a> does not make use of use of any optimization.<a href="#appendix-A-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.2">
          <a href="#example-with-optimization" class="xref">Appendix A.2</a> makes use of the optimizations defined in this specification, hence reducing the roundtrips of the interactions between the Client and RS.<a href="#appendix-A-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.3">
          <a href="#example-without-optimization-as-posting" class="xref">Appendix A.3</a> does not make use of any optimization, but consider an alternative workflow where the AS uploads the access token to the RS.<a href="#appendix-A-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-A-3">All these examples build on the following assumptions, as relying on expected early procedures performed at the AS. These include the registration of RSs by the respective Resource Owners as well as the registrations of Clients authorized to request access token for those RSs.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-4.1">The AS knows the authentication credential AUTH_CRED_C of the Client C.<a href="#appendix-A-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-4.2">The Client knows the authentication credential AUTH_CRED_AS of the AS.<a href="#appendix-A-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-4.3">The AS knows the authentication credential AUTH_CRED_RS of RS.<a href="#appendix-A-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-4.4">
          <p id="appendix-A-4.4.1">The RS knows the authentication credential AUTH_CRED_AS of the AS.<a href="#appendix-A-4.4.1" class="pilcrow">¶</a></p>
<p id="appendix-A-4.4.2">
This is relevant in case the AS and RS actually require a secure association (e.g., for the RS to perform token introspection at the AS, or for the AS to upload an access token to the RS on behalf of the Client).<a href="#appendix-A-4.4.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-5">As a result of the assumptions above, it is possible to limit the transport of AUTH_CRED_C and AUTH_CRED_RS by value only to the following two cases, and only when the Client requests an access token for the RS in question for the first time when considering the pair (AUTH_CRED_C, AUTH_CRED_RS).<a href="#appendix-A-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-6.1">In the Token Response from the AS to the Client, where AUTH_CRED_RS is specified by the 'rs_cnf' parameter.<a href="#appendix-A-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-6.2">
          <p id="appendix-A-6.2.1">In the access token, where AUTH_CRED_C is specified by the 'cnf' claim.<a href="#appendix-A-6.2.1" class="pilcrow">¶</a></p>
<p id="appendix-A-6.2.2">
Note that, even under the circumstances mentioned above, AUTH_CRED_C might rather be indicated by reference. This is possible if the RS can effectively use such a reference from the access token to retrieve AUTH_CRED_C (e.g., from a trusted repository of authentication credentials reachable through a non-constrained link), and if the AS is in turn aware of that.<a href="#appendix-A-6.2.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-7">In any other case, it is otherwise possible to indicate both AUTH_CRED_C and AUTH_CRED_RS by reference, when performing the ACE access control workflow as well as later on when the Client and RS run EDHOC.<a href="#appendix-A-7" class="pilcrow">¶</a></p>
<div id="example-without-optimization">
<section id="appendix-A.1">
        <h3 id="name-workflow-without-optimizati">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-workflow-without-optimizati" class="section-name selfRef">Workflow without Optimizations</a>
        </h3>
<p id="appendix-A.1-1">The example below considers the simplest (though least efficient) interaction between the Client and RS. That is: first the Client uploads the access token to the RS; then the Client and RS run EDHOC; and, finally, the Client accesses the protected resource at the RS.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-2">
<pre>
    C                                 AS                             RS
    |                                  |                              |
    |  EDHOC message_1 to /edhoc       |                              |
M01 |---------------------------------&gt;|                              |
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_2                 |                              |
M02 |&lt;---------------------------------|                              |
    |  ID_CRED_R identifies            |                              |
    |     CRED_R = AUTH_CRED_AS        |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_3 to /edhoc       |                              |
M03 |---------------------------------&gt;|                              |
    |  ID_CRED_I identifies            |                              |
    |     CRED_I = AUTH_CRED_C         |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |                                  |                              |
    |  Token request to /token         |                              |
    |  (OSCORE-protected message)      |                              |
M04 |---------------------------------&gt;|                              |
    |  'req_cnf' identifies            |                              |
    |     AUTH_CRED_C by reference     |                              |
    |                                  |                              |
    |                                  |                              |
    |  Token response                  |                              |
    |  (OSCORE-protected message)      |                              |
M05 |&lt;---------------------------------|                              |
    |  'rs_cnf' specifies              |                              |
    |     AUTH_CRED_RS by value        |                              |
    |                                  |                              |
    |  'ace_profile' =                 |                              |
    |             coap_edhoc_oscore    |                              |
    |                                  |                              |
    |  'edhoc_params' specifies:       |                              |
    |     {                            |                              |
    |       id     : h'01',            |                              |
    |       suite  : 2,                |                              |
    |       methods: 3                 |                              |
    |     }                            |                              |
    |                                  |                              |
    |  In the access token:            |                              |
    |     * the 'cnf' claim specifies  |                              |
    |       AUTH_CRED_C by value       |                              |
    |     * the 'edhoc_params' claim   |                              |
    |       specifies the same as      |                              |
    |       'edhoc_params' above       |                              |
    |                                  |                              |

 // Possibly after chain verification, the Client adds AUTH_CRED_RS
 // to the set of its trusted peer authentication credentials,
 // relying on the AS as trusted provider

    |                                  |                              |
    |  Token upload to /authz-info     |                              |
    |  (unprotected message)           |                              |
M06 |----------------------------------------------------------------&gt;|
    |                                  |                              |

 // Possibly after chain verification, the RS adds AUTH_CRED_C
 // to the set of its trusted peer authentication credentials,
 // relying on the AS as trusted provider

    |                                  |                              |
    |   2.01 (Created)                 |                              |
    |   (unprotected message)          |                              |
M07 |&lt;----------------------------------------------------------------|
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_1 to /edhoc       |                              |
    |  (no access control is enforced) |                              |
M08 |----------------------------------------------------------------&gt;|
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_2                 |                              |
M09 |&lt;----------------------------------------------------------------|
    |  ID_CRED_R identifies            |                              |
    |     CRED_R = AUTH_CRED_RS        |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_3 to /edhoc       |                              |
    |  (no access control is enforced) |                              |
M10 |----------------------------------------------------------------&gt;|
    |  ID_CRED_I identifies            |                              |
    |     CRED_I = AUTH_CRED_C         |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |                                  |                              |
    |  Access to protected resource    |                              |
    |  (OSCORE-protected message)      |                              |
    |  (access control is enforced)    |                              |
M11 |----------------------------------------------------------------&gt;|
    |                                  |                              |
    |  Response                        |                              |
    |  (OSCORE-protected message)      |                              |
M12 |&lt;----------------------------------------------------------------|
    |                                  |                              |

 // Later on, the access token expires ...
 //  - The Client and RS delete their OSCORE Security Context and
 //    terminate the EDHOC session used to derive it (unless the same
 //    session is also used for other reasons).
 //  - The RS retains AUTH_CRED_C as still valid,
 //    and the AS knows about it.
 //  - The Client retains AUTH_CRED_RS as still valid,
 //    and the AS knows about it.

    |                                  |                              |
    |                                  |                              |

 // Time passes ...

    |                                  |                              |
    |                                  |                              |

 // The Client asks for a new access token; now all the
 // authentication credentials can be indicated by reference

 // The price to pay is on the AS, about remembering that at least
 // one access token has been issued for the pair (Client, RS)
 // and considering the pair (AUTH_CRED_C, AUTH_CRED_RS)

    |                                  |                              |
    |  Token request to /token         |                              |
    |  (OSCORE-protected message)      |                              |
M13 |---------------------------------&gt;|                              |
    |  'req_cnf' identifies            |                              |
    |     CRED_I = AUTH_CRED_C         |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |                                  |                              |
    |  Token response                  |                              |
    |  (OSCORE-protected message)      |                              |
M14 |&lt;---------------------------------|                              |
    |  'rs_cnf' identifies             |                              |
    |     AUTH_CRED_RS by reference    |                              |
    |                                  |                              |
    |  'ace_profile' =                 |                              |
    |             coap_edhoc_oscore    |                              |
    |                                  |                              |
    |  'edhoc_params' specifies:       |                              |
    |     {                            |                              |
    |       id     : h'05',            |                              |
    |       suite  : 2,                |                              |
    |       methods: 3                 |                              |
    |     }                            |                              |
    |                                  |                              |
    |  In the access token:            |                              |
    |     * the 'cnf' claim specifies  |                              |
    |       AUTH_CRED_C by reference   |                              |
    |     * the 'edhoc_params' claim   |                              |
    |       specifies the same as      |                              |
    |       'edhoc_params' above       |                              |
    |                                  |                              |
    |                                  |                              |
    |  Token upload to /authz-info     |                              |
    |  (unprotected message)           |                              |
M15 |----------------------------------------------------------------&gt;|
    |                                  |                              |
    |                                  |                              |
    |  2.01 (Created)                 |                              |
    |  (unprotected message)           |                              |
M16 |&lt;----------------------------------------------------------------|
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_1 to /edhoc       |                              |
    |  (no access control is enforced) |                              |
M17 |----------------------------------------------------------------&gt;|
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_2                 |                              |
    |  (no access control is enforced) |                              |
M18 |&lt;----------------------------------------------------------------|
    |  ID_CRED_R specifies             |                              |
    |     CRED_R = AUTH_CRED_RS        |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_3 to /edhoc       |                              |
    |  (no access control is enforced) |                              |
M19 |----------------------------------------------------------------&gt;|
    |  ID_CRED_I identifies            |                              |
    |     CRED_I = AUTH_CRED_C         |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |                                  |                              |
    |  Access to protected resource /r |                              |
    |  (OSCORE-protected message)      |                              |
    |  (access control is enforced)    |                              |
M20 |----------------------------------------------------------------&gt;|
    |                                  |                              |
    |                                  |                              |
    |  Response                        |                              |
    |  (OSCORE-protected message)      |                              |
M21 |&lt;----------------------------------------------------------------|
    |                                  |                              |
</pre><a href="#appendix-A.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-with-optimization">
<section id="appendix-A.2">
        <h3 id="name-workflow-with-optimizations">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-workflow-with-optimizations" class="section-name selfRef">Workflow with Optimizations</a>
        </h3>
<p id="appendix-A.2-1">The example below builds on the example in <a href="#example-without-optimization" class="xref">Appendix A.1</a>, while additionally relying on the two following optimizations.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2-2.1">The access token is not separately uploaded to the /authz-info endpoint at the RS, but rather included in the EAD_1 parameter of EDHOC message_1 sent by the Client to the RS.<a href="#appendix-A.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-2.2">The Client uses the EDHOC+OSCORE request defined in <span>[<a href="#I-D.ietf-core-oscore-edhoc" class="xref">I-D.ietf-core-oscore-edhoc</a>]</span> is used, when running EDHOC both with the AS and with the RS.<a href="#appendix-A.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-A.2-3">These two optimizations used together result in the most efficient interaction between the Client and RS, as consisting of only two roundtrips to upload the access token, run EDHOC and access the protected resource at the RS.<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
<p id="appendix-A.2-4">Also, a further optimization is used upon uploading a second access token to the RS, following the expiration of the first one. That is, after posting the second access token, the Client and RS do not run EDHOC again, but rather EDHOC-KeyUpdate() and EDHOC-Exporter() building on the same EDHOC session established before.<a href="#appendix-A.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-5">
<pre>
    C                                 AS                             RS
    |                                  |                              |
    |  EDHOC message_1 to /edhoc       |                              |
M01 |---------------------------------&gt;|                              |
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_2                 |                              |
M02 |&lt;---------------------------------|                              |
    |  ID_CRED_R identifies            |                              |
    |     CRED_R = AUTH_CRED_AS        |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |                                  |                              |
    |  EDHOC+OSCORE request to /token  |                              |
M03 |---------------------------------&gt;|                              |
    |  * EDHOC message_3               |                              |
    |      ID_CRED_I identifies        |                              |
    |         CRED_I = AUTH_CRED_C     |                              |
    |         by reference             |                              |
    |  --- --- ---                     |                              |
    |  * OSCORE-protected part         |                              |
    |      Token request               |                              |
    |         'req_cnf' identifies     |                              |
    |         AUTH_CRED_C by reference |                              |
    |                                  |                              |
    |                                  |                              |
    |  Token response                  |                              |
    |  (OSCORE-protected message)      |                              |
M04 |&lt;---------------------------------|                              |
    |  'rs_cnf' specifies              |                              |
    |     AUTH_CRED_RS by value        |                              |
    |                                  |                              |
    |  'ace_profile' =                 |                              |
    |             coap_edhoc_oscore    |                              |
    |                                  |                              |
    |  'edhoc_params' specifies:       |                              |
    |     {                            |                              |
    |       id     : h'01',            |                              |
    |       suite  : 2,                |                              |
    |       methods: 3                 |                              |
    |     }                            |                              |
    |                                  |                              |
    |  In the access token:            |                              |
    |     * the 'cnf' claim specifies  |                              |
    |       AUTH_CRED_C by value       |                              |
    |     * the 'edhoc_params' claim   |                              |
    |       specifies the same as      |                              |
    |       'edhoc_params' above       |                              |
    |                                  |                              |

 // Possibly after chain verification, the Client adds AUTH_CRED_RS
 // to the set of its trusted peer authentication credentials,
 // relying on the AS as trusted provider

    |                                  |                              |
    |  EDHOC message_1 to /edhoc       |                              |
    |  (no access control is enforced) |                              |
M05 |----------------------------------------------------------------&gt;|
    |  Access token specified in EAD_1 |                              |
    |                                  |                              |

 // Possibly after chain verification, the RS adds AUTH_CRED_C
 // to the set of its trusted peer authentication credentials,
 // relying on the AS as trusted provider

    |                                  |                              |
    |  EDHOC message_2                 |                              |
M06 |&lt;----------------------------------------------------------------|
    |  ID_CRED_R identifies            |                              |
    |     CRED_R = AUTH_CRED_RS        |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |                                  |                              |
    |  EDHOC+OSCORE request to /r      |                              |
M07 |----------------------------------------------------------------&gt;|
    |  * EDHOC message_3               |                              |
    |      ID_CRED_I identifies        |                              |
    |         CRED_I = AUTH_CRED_C     |                              |
    |         by reference             |                              |
    |  --- --- ---                     |                              |
    |  * OSCORE-protected part         |                              |
    |      Application request to /r   |                              |
    |                                  |                              |

 // After the EDHOC processing is completed, access control
 // is enforced on the rebuilt OSCORE-protected request,
 // like if it had been sent stand-alone

    |                                  |                              |
    |  Response                        |                              |
    |  (OSCORE-protected message)      |                              |
M08 |&lt;----------------------------------------------------------------|
    |                                  |                              |

 // Later on, the access token expires ...
 //  - The Client and RS delete their OSCORE Security Context and
 //    terminate the EDHOC session used to derive it (unless the same
 //    session is also used for other reasons).
 //  - The RS retains AUTH_CRED_C as still valid,
 //    and the AS knows about it.
 //  - The Client retains AUTH_CRED_RS as still valid,
 //    and the AS knows about it.

    |                                  |                              |
    |                                  |                              |

 // Time passes ...

    |                                  |                              |
    |                                  |                              |

 // The Client asks for a new access token; now all the
 // authentication credentials can be indicated by reference

 // The price to pay is on the AS, about remembering that at least
 // one access token has been issued for the pair (Client, RS)
 // and considering the pair (AUTH_CRED_C, AUTH_CRED_RS)

    |                                  |                              |
    |  Token request to /token         |                              |
    |  (OSCORE-protected message)      |                              |
M09 |---------------------------------&gt;|                              |
    |  'req_cnf' identifies            |                              |
    |     CRED_I = AUTH_CRED_C         |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |  Token response                  |                              |
    |  (OSCORE-protected message)      |                              |
M10 |&lt;---------------------------------|                              |
    |  'rs_cnf' identifies             |                              |
    |     AUTH_CRED_RS by reference    |                              |
    |                                  |                              |
    |  'ace_profile' =                 |                              |
    |             coap_edhoc_oscore    |                              |
    |                                  |                              |
    |  'edhoc_params' specifies:       |                              |
    |     {                            |                              |
    |       id     : h'05',            |                              |
    |       suite  : 2,                |                              |
    |       methods: 3                 |                              |
    |     }                            |                              |
    |                                  |                              |
    |  In the access token:            |                              |
    |     * the 'cnf' claim specifies  |                              |
    |       AUTH_CRED_C by reference   |                              |
    |     * the 'edhoc_params' claim   |                              |
    |       specifies the same as      |                              |
    |       'edhoc_params' above       |                              |
    |                                  |                              |
    |                                  |                              |
    |  Token upload to /authz-info     |                              |
    |  (unprotected message)           |                              |
M11 |----------------------------------------------------------------&gt;|
    |   Payload {                      |                              |
    |     access_token: access token   |                              |
    |     nonce_1: N1  // nonce        |                              |
    |   }                              |                              |
    |                                  |                              |
    |                                  |                              |
    |  2.01 (Created)                  |                              |
    |  (unprotected message)           |                              |
M12 |&lt;----------------------------------------------------------------|
    |   Payload {                      |                              |
    |     nonce_2: N2  // nonce        |                              |
    |   }                              |                              |
    |                                  |                              |

 // The Client and RS first run EDHOC-KeyUpdate(N1 | N2), and
 // then EDHOC-Exporter() to derive a new OSCORE Master Secret and
 // OSCORE Master Salt, from which a new OSCORE Security Context is
 // derived. The Sender/Recipiend IDs are the same C_I and C_R from
 // the previous EDHOC execution

    |                                  |                              |
    |  Access to protected resource /r |                              |
    |  (OSCORE-protected message)      |                              |
    |  (access control is enforced)    |                              |
M13 |----------------------------------------------------------------&gt;|
    |                                  |                              |
    |                                  |                              |
    |  Response                        |                              |
    |  (OSCORE-protected message)      |                              |
M14 |&lt;----------------------------------------------------------------|
    |                                  |                              |
</pre><a href="#appendix-A.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-without-optimization-as-posting">
<section id="appendix-A.3">
        <h3 id="name-workflow-without-optimizatio">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-workflow-without-optimizatio" class="section-name selfRef">Workflow without Optimizations (AS token posting)</a>
        </h3>
<p id="appendix-A.3-1">The example below builds on the example in <a href="#example-without-optimization" class="xref">Appendix A.1</a>, but assumes that the AS is uploading the access token to the RS on behalf of C.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3-2">In order to save roundtrips between the Client and RS, further, more efficient interactions can be seamlessly considered, e.g., as per the example in <a href="#example-with-optimization" class="xref">Appendix A.2</a>.<a href="#appendix-A.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3-3">
<pre>
    C                                 AS                             RS
    |                                  |                              |
    |                                  | Establish secure association |
    |                                  | (e.g., OSCORE using EDHOC)   |
    |                                  |&lt;----------------------------&gt;|
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_1 to /edhoc       |                              |
M01 |---------------------------------&gt;|                              |
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_2                 |                              |
M02 |&lt;---------------------------------|                              |
    |  ID_CRED_R identifies            |                              |
    |     CRED_R = AUTH_CRED_AS        |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_3 to /edhoc       |                              |
M03 |---------------------------------&gt;|                              |
    |  ID_CRED_I identifies            |                              |
    |     CRED_I = AUTH_CRED_C         |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |                                  |                              |
    |  Token request to /token         |                              |
    |  (OSCORE-protected message)      |                              |
M04 |---------------------------------&gt;|                              |
    |  'req_cnf' identifies            |                              |
    |     AUTH_CRED_C by reference     |                              |
    |                                  |                              |
    |                                  |                              |
    |                                  |  Token upload to /authz-info |
    |                                  |  (OSCORE-protected message)  |
M05 |                                  |-----------------------------&gt;|
    |                                  |  In the access token:        |
    |                                  |     * the 'cnf' claim        |
    |                                  |       specifies AUTH_CRED_C  |
    |                                  |       by value               |
    |                                  |     * the 'edhoc_params'     |
    |                                  |       claim specifies        |
    |                                  |         {                    |
    |                                  |           id     : h'01',    |
    |                                  |           suite  : 2,        |
    |                                  |           methods: 3         |
    |                                  |         }                    |
    |                                  |                              |

 // Possibly after chain verification, the RS adds AUTH_CRED_C
 // to the set of its trusted peer authentication credentials,
 // relying on the AS as trusted provider

    |                                  |                              |
    |                                  |  2.01 (Created)              |
    |                                  |  (OSCORE-protected message)  |
M06 |                                  |&lt;-----------------------------|
    |                                  |                              |
    |                                  |                              |
    |  Token response                  |                              |
    |  (OSCORE-protected message)      |                              |
M07 |&lt;---------------------------------|                              |
    |  'rs_cnf' specifies              |                              |
    |     AUTH_CRED_RS by value        |                              |
    |                                  |                              |
    |  'ace_profile' =                 |                              |
    |             coap_edhoc_oscore    |                              |
    |                                  |                              |
    |  'token_uploaded' = true         |                              |
    |                                  |                              |
    |  'edhoc_params' specifies:       |                              |
    |     {                            |                              |
    |       id     : h'01',            |                              |
    |       suite  : 2,                |                              |
    |       methods: 3                 |                              |
    |     }                            |                              |
    |                                  |                              |


 // Possibly after chain verification, the Client adds AUTH_CRED_RS
 // to the set of its trusted peer authentication credentials,
 // relying on the AS as trusted provider

    |                                  |                              |
    |  EDHOC message_1 to /edhoc       |                              |
    |  (no access control is enforced) |                              |
M08 |----------------------------------------------------------------&gt;|
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_2                 |                              |
M09 |&lt;----------------------------------------------------------------|
    |  ID_CRED_R identifies            |                              |
    |     CRED_R = AUTH_CRED_RS        |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_3 to /edhoc       |                              |
    |  (no access control is enforced) |                              |
M10 |----------------------------------------------------------------&gt;|
    |  ID_CRED_I identifies            |                              |
    |     CRED_I = AUTH_CRED_C         |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |                                  |                              |
    |  Access to protected resource    |                              |
    |  (OSCORE-protected message)      |                              |
    |  (access control is enforced)    |                              |
M11 |----------------------------------------------------------------&gt;|
    |                                  |                              |
    |                                  |                              |
    |  Response                        |                              |
    |  (OSCORE-protected message)      |                              |
M12 |&lt;----------------------------------------------------------------|
    |                                  |                              |

 // Later on, the access token expires ...
 //  - The Client and RS delete their OSCORE Security Context and
 //    terminate the EDHOC session used to derive it (unless the same
 //    session is also used for other reasons).
 //  - The RS retains AUTH_CRED_C as still valid,
 //    and the AS knows about it.
 //  - The Client retains AUTH_CRED_RS as still valid,
 //    and the AS knows about it.

    |                                  |                              |
    |                                  |                              |

 // Time passes ...

    |                                  |                              |
    |                                  |                              |

 // The Client asks for a new access token; now all the
 // authentication credentials can be indicated by reference

 // The price to pay is on the AS, about remembering that at least
 // one access token has been issued for the pair (Client, RS)
 // and considering the pair (AUTH_CRED_C, AUTH_CRED_RS)

    |                                  |                              |
    |  Token request to /token         |                              |
    |  (OSCORE-protected message)      |                              |
M13 |---------------------------------&gt;|                              |
    |  'req_cnf' identifies            |                              |
    |     CRED_I = AUTH_CRED_C         |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |                                  |                              |
    |                                  |  Token upload to /authz-info |
    |                                  |  (OSCORE-protected message)  |
M14 |                                  |-----------------------------&gt;|
    |                                  |  In the access token:        |
    |                                  |     * the 'cnf' claim        |
    |                                  |       specifies AUTH_CRED_C  |
    |                                  |       by reference           |
    |                                  |     * the 'edhoc_params'     |
    |                                  |       claim specifies        |
    |                                  |         {                    |
    |                                  |           id     : h'05',    |
    |                                  |           suite  : 2,        |
    |                                  |           methods: 3         |
    |                                  |         }                    |
    |                                  |                              |
    |                                  |                              |
    |                                  |  2.01 (Created)              |
    |                                  |  (OSCORE-protected message)  |
M15 |                                  |&lt;-----------------------------|
    |                                  |                              |
    |                                  |                              |
    |  Token response                  |                              |
    |  (OSCORE-protected message)      |                              |
M16 |&lt;---------------------------------|                              |
    |  'rs_cnf' specifies              |                              |
    |     AUTH_CRED_RS by reference    |                              |
    |                                  |                              |
    |  'ace_profile' =                 |                              |
    |             coap_edhoc_oscore    |                              |
    |                                  |                              |
    |  'token_uploaded' = true         |                              |
    |                                  |                              |
    |  'edhoc_params' specifies:       |                              |
    |     {                            |                              |
    |       id     : h'05',            |                              |
    |       suite  : 2,                |                              |
    |       methods: 3                 |                              |
    |     }                            |                              |
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_1 to /edhoc       |                              |
    |  (no access control is enforced) |                              |
M17 |----------------------------------------------------------------&gt;|
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_2                 |                              |
    |  (no access control is enforced) |                              |
M18 |&lt;----------------------------------------------------------------|
    |  ID_CRED_R specifies             |                              |
    |     CRED_R = AUTH_CRED_RS        |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |                                  |                              |
    |  EDHOC message_3 to /edhoc       |                              |
    |  (no access control is enforced) |                              |
M19 |----------------------------------------------------------------&gt;|
    |  ID_CRED_I identifies            |                              |
    |     CRED_I = AUTH_CRED_C         |                              |
    |     by reference                 |                              |
    |                                  |                              |
    |                                  |                              |
    |  Access to protected resource /r |                              |
    |  (OSCORE-protected message)      |                              |
    |  (access control is enforced)    |                              |
M20 |----------------------------------------------------------------&gt;|
    |                                  |                              |
    |                                  |                              |
    |  Response                        |                              |
    |  (OSCORE-protected message)      |                              |
M21 |&lt;----------------------------------------------------------------|
    |                                  |                              |
</pre><a href="#appendix-A.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="acknowldegment">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">Work on this document has in part been supported by the H2020 project SIFIS-Home (grant agreement 952652).<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Göran Selander</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:goran.selander@ericsson.com" class="email">goran.selander@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Preuß Mattsson</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:john.mattsson@ericsson.com" class="email">john.mattsson@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rikard Höglund</span></div>
<div dir="auto" class="left"><span class="org">RISE</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rikard.hoglund@ri.se" class="email">rikard.hoglund@ri.se</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
